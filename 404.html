<!DOCTYPE html>
<head>
   <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
   <meta http-equiv="Pragma" content="no-cache">
   <meta http-equiv="Expires" content="-1">
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>MusicBrainz Picard Documentation</title>
</head>
<body>
   <!-- <div id='test'></div> -->
   <script>
      var target_language = 'en';
      var target_version = '';
      var src_host = window.location.hostname;
      var src_protocol = window.location.protocol;
      var src_path = window.location.pathname;
      var src_path_parts = src_path.split('/');
      var target_path = '';
      var target_url = src_protocol + '//' + src_host + '/en/not_found.html';

      const re_language = /^[a-z][a-z](-[A-Z][A-Z])?$/;
      const re_version = /^[0-9][0-9\.]*$/;

      function is_language(test_language) {
         // document.getElementById('test').innerHTML += '<p>Test Language = ' + test_language + '</p>';
         if (test_language.search(re_language) < 0) {
            // document.getElementById('test').innerHTML += '<p>Test Result = False</p>';
            return false
         }
         target_language = test_language;
         // document.getElementById('test').innerHTML += '<p>Test Result = True</p>';
         return true;
      }

      function is_version(test_version) {
         // document.getElementById('test').innerHTML += '<p>Test Version = ' + test_version + '</p>';
         if (test_version.search(re_version) < 0) {
            // document.getElementById('test').innerHTML += '<p>Test Result = False</p>';
            return false
         }
         target_version = 'v' + test_version;
         // document.getElementById('test').innerHTML += '<p>Test Result = True</p>';
         return true;
      }

      var counter = 1;
      if (is_language(src_path_parts[counter])) {
         counter += 1;
         // document.getElementById('test').innerHTML += '<p>counter = ' + counter + '</br>length = ' + src_path_parts.length + '</p>'
         if (counter < src_path_parts.length) {
            if ((is_version(src_path_parts[counter])) || (src_path_parts[counter].search(/^(latest|stable)$/) >= 0)) {
               if (is_version(src_path_parts[counter])) {
                  target_path = '/' + target_version;
               }
               counter += 1;
               target_path += '/' + target_language;
               while (counter < src_path_parts.length) {
                  target_path += '/' + src_path_parts[counter];
                  counter += 1;
               }
               target_url = src_protocol + '//' + src_host + target_path;
               // document.getElementById('content').innerHTML = 'The page may have been moved to <a href="' + target_url + '">' + target_url + '</a>.';
            }
         }
      }
      window.location.replace(target_url);
   </script>
</body>
</html>
